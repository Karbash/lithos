<div class="modal-overlay" (click)="onClose()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <header class="modal-header">
      <h2>{{ modo() === 'iniciar' ? 'Iniciar Turno' : 'Finalizar Turno' }}</h2>
      <span class="forno-nome">{{ fornoNome() }}</span>
      <button class="close-btn" (click)="onClose()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </header>

    @if (modo() === 'iniciar') {
      <form [formGroup]="formIniciar" (ngSubmit)="onIniciar()" class="modal-form">
        <div class="form-group">
          <label for="turno">Turno</label>
          <select id="turno" formControlName="turno">
            <option value="A">Turno A (06:00 - 14:00)</option>
            <option value="B">Turno B (14:00 - 22:00)</option>
            <option value="C">Turno C (22:00 - 06:00)</option>
          </select>
        </div>

        <div class="form-group">
          <label for="operador">Operador</label>
          <input type="text" id="operador" formControlName="operador" placeholder="Nome do operador">
        </div>

        <div class="form-group">
          <label for="temperaturaInicio">Temperatura Inicial (°C)</label>
          <input type="number" id="temperaturaInicio" formControlName="temperaturaInicio" min="0" max="2000">
        </div>

        <div class="form-group">
          <label for="observacoes">Observações</label>
          <textarea id="observacoes" formControlName="observacoes" rows="3" placeholder="Observações opcionais"></textarea>
        </div>

        <div class="modal-actions">
          <button type="button" class="btn-secondary" (click)="onClose()">Cancelar</button>
          <button type="submit" class="btn-primary" [disabled]="formIniciar.invalid">Iniciar Turno</button>
        </div>
      </form>
    } @else {
      <div class="registro-info">
        <div class="info-item">
          <span class="label">Operador</span>
          <span class="value">{{ registroAberto()?.operador }}</span>
        </div>
        <div class="info-item">
          <span class="label">Turno</span>
          <span class="value">{{ registroAberto()?.turno }}</span>
        </div>
        <div class="info-item">
          <span class="label">Início</span>
          <span class="value">{{ registroAberto()?.horaInicio }}</span>
        </div>
        <div class="info-item">
          <span class="label">Temp. Inicial</span>
          <span class="value">{{ registroAberto()?.temperaturaInicio }}°C</span>
        </div>
      </div>

      <form [formGroup]="formFinalizar" (ngSubmit)="onFinalizar()" class="modal-form">
        <div class="form-group">
          <label for="temperaturaFim">Temperatura Final (°C)</label>
          <input type="number" id="temperaturaFim" formControlName="temperaturaFim" min="0" max="2000">
        </div>

        <div class="form-group">
          <label for="producao">Produção (ton)</label>
          <input type="number" id="producao" formControlName="producao" min="0" step="0.1">
        </div>

        <div class="form-group">
          <label for="observacoesFim">Observações</label>
          <textarea id="observacoesFim" formControlName="observacoes" rows="3" placeholder="Observações do turno"></textarea>
        </div>

        <div class="modal-actions">
          <button type="button" class="btn-secondary" (click)="onClose()">Cancelar</button>
          <button type="submit" class="btn-primary" [disabled]="formFinalizar.invalid">Finalizar Turno</button>
        </div>
      </form>
    }
  </div>
</div>
